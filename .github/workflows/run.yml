name: fetch-data
on: 
  push:
  schedule:
    - cron: "30 11 * * *"

jobs:
  refresh-permits:
    runs-on: ubuntu-latest
    env:
      AIRTABLE_BASE_ID: ${{ secrets.AIRTABLE_BASE_ID }}
      AIRTABLE_TOKEN: ${{ secrets.AIRTABLE_TOKEN }}
    steps:
      - name: checkout repo content
        uses: actions/checkout@v2
      - name: setup node
        run: npm ci --omit=dev
      - name: create env file
        run: |
          touch .env
          echo AIRTABLE_BASE_ID=${{ secrets.AIRTABLE_BASE_ID }} >> .env
          echo AIRTABLE_TOKEN=${{ secrets.AIRTABLE_TOKEN }} >> .env
      - name: run fetch
        run: npm run fetch